<% layout('layouts/boilerplate') %>

    <h1>Journal</h1>
    <p>This is the journal page</p>
    <% if (currentUser){ %>
        <div class="row">
            <h1 class="text-center">New Entry</h1>
            <div class="col-6 offset-3">
                <form action="/users/journal" method="POST" class="validated-form" novalidate>
                    <div class="mb-3">
                        <label class="form-label" for="date">Date</label>
                        <input class="form-control" type="date" id="date" name="journal[date]">
                    </div>
                    <div class="mb-3">
                        <label for="data" class="form-label">Entry</label>
                        <textarea class="form-control" id="data" rows="3" name="journal[data]" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="technique" class="form-label">Technique</label>
                        <select class="form-select" id="technique" name="journal[technique]">
                            <% for (let tech of techniques) { %>
                                <option value="<%=tech.id %>">
                                    <%=tech.name %>
                                </option>
                                <% } %>
                        </select>
                    </div>
                    <input type="hidden" id="userId" name="journal[userId]" value="<%=currentUser.id%>">
                    <div class="mb-3">
                        <button class="btn btn-success">Submit</button>
                    </div>
                </form>
            </div>
        </div>
        <% } %>

            <% for (entry of journals) {%>
                <p>
                    <%= entry.data %>
                </p>
                <% } %>
                    <script>
                        const journalDate = document.getElementById('date')
                        if (journalDate) { journalDate.valueAsDate = new Date(); }
                    </script>